
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    match /cars/{allPaths=**} {
      // Allow anyone to read images from the 'cars' folder.
      // This is necessary for the public catalog to display vehicle images.
      allow read: if true;
      
      // Allow writes (create, update, delete) only if the user is authenticated
      // and has an 'admin' role in their custom claims.
      allow write: if request.auth != null && request.auth.token.role == 'admin';
    }
  }
}
